# Build user-spefic kubernetes spark image from bigdl image

ARG BIGDL_IMAGE_NAME
ARG BIGDL_IMAGE_VERSION

FROM $BIGDL_IMAGE_NAME:$BIGDL_IMAGE_VERSION

ADD ./enclave-key.pem /graphene/Pal/src/host/Linux-SGX/signer/enclave-key.pem
RUN cd /ppml/trusted-big-data-ml && \
    ./init.sh && \
    rm /graphene/Pal/src/host/Linux-SGX/signer/enclave-key.pem

WORKDIR /ppml/trusted-big-data-ml

ENTRYPOINT [ "/opt/entrypoint.sh" ]

